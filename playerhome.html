<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<meta charset="utf-8" /> 
		<title>Gamelab</title>
		<link rel="stylesheet" href="@@htdocs@@/style.css" type="text/css" />
		<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" />
		<style>
			fieldset { box-shadow: none; }
			form { margin-left: auto; margin-right: auto; max-width: 100%; }
		</style>
		<script src="@@htdocs@@/script.js"></script>
		<script src="@@cgibin@@/home.js"></script>
	</head>
	<body onload="loadExpr();" onclick="onNavUp();" id="playerHomeBase">
		<header>
			<a id="navButton" href="#" onclick="return(onNav(event));"><i class="fa fa-navicon"></i></a>
			<h1>gamelab</h1>
			<span>
				Next round: <span id="exprCountdown"><i class="fa fa-spinner fa-spin"></i></span>
			</span>
			<div id="navParent">
				<nav id="nav">
					<ul>
						<li><a href="#defaultTab"><i class="fa fa-fw fa-info"></i> Instructions</a></li>
						<li><a href="#play"><i class="fa fa-fw fa-play"></i> Play</a></li>
						<li><a href="#history"><i class="fa fa-fw fa-history"></i> History</a></li>
						<li><a href="@@cgibin@@/dologout.html"><i class="fa fa-fw fa-sign-out"></i> Logout</a></li>
					</ul>
				</nav>
			</div>
		</header>
		<article id="history" class="tab">
			<h2>History of play</h2>
			<div id="historyLoading"><i class="fa fa-spinner fa-spin"></i></div>
			<div id="historyLoaded" class="noshow">
				<section id="historyPlay" class="noshow">
					<nav id="historyNav">
						Game 
						<a href="#" onclick='showHistoryGamePrev(); return false;'><i class="fa fa-arrow-circle-left"></i></a>
						<select id="historySelectGame" onchange="showHistory();"></select>
						<a href="#" onclick='showHistoryGameNext(); return false;'><i class="fa fa-arrow-circle-right"></i></a>,
						Round 
						<a href="#" onclick='showHistoryRoundPrev(); return false;'><i class="fa fa-toggle-left"></i></a>
						<select id="historySelectRound" onchange="showHistory();"></select>
						<a href="#" onclick='showHistoryRoundNext(); return false;'><i class="fa fa-toggle-right"></i></a>
					</nav>
					<h3>Game and round specifics</h3>
					<div id="historyRoundups"></div>
					<div id="bimatrixRoundups"></div>
					<h3>Round specifics</h3>
					<div id="lotteryRoundups"></div>
					<h2>Total payoffs</h2>
					<p>
						Your total payoff from all rounds and games: <span id="historyLottery"></span>
					</p>
				</section>
				<section id="historyNotYet" class="noshow">
					<p>
						This is the first round: there is no history to report yet.
					</p>
				</section>
				<section id="historyNotStarted" class="noshow">
					<p>
						Waiting for game to start...
					</p>
				</section>
			</div>
		</article>
		<article id="play" class="tab">
			<h2>Play Game</h2>
			<div id="exprLoading"><i class="fa fa-spinner fa-spin"></i></div>
			<div id="exprLoaded" class="noshow">
				<section id="exprNotStarted" class="noshow">
					<p>
						Waiting for game to start...
					</p>
				</section>
				<section id="exprDone" class="noshow">
					<p>
						You've played all the games for this round.
						Please wait to play again.
					</p>
				</section>
				<section id="exprFinished" class="noshow">
					<p>
						Experiment is finished.
					</p>
					<p id="exprFinishedResults">
						You were awarded <span id="exprFinishedTickets"></span> tickets out of <span id="exprFinishedTicketsMax"></span>.
					</p>
					<p id="exprFinishedWin">
						You have WON.  Rank <span id="exprFinishedWinRank">foo</span>.
					</p>
					<p id="exprFinishedWinWait">
						Waiting for winning result...
					</p>
				</section>
				<section id="exprPlay" class="noshow">
					<h3>
						Game <span id="playGameNum"></span> of <span id="playGameMax"></span>,
						round <span id="playRoundNum"></span> of <span id="playRoundMax"></span>
					</h3>
					<div id="exprHistory">
						<div>
							Your payoff from this game in the previous round:
							<span id="exprHistoryLottery"></span><span id="exprHistoryPlays"></span>
						</div>
						<div id="skipExplain">
							<div class="warning">
								<div>
									<div><i class="fa fa-exclamation-circle"></i></div>
									<div>
										In the last round, not enough participants played, so no points were tallied for the round.
									</div>
								</div>
							</div>
						</div>
						<h4>Play in the last round</h4>
						<div id="exprHistoryMatrix"></div>
					</div>
					<aside>
						<div>
							You are the <span id="playerColour">row player</span>: select your strategies.
						</div>
						<div>
							Once selected, you must enter probabilities for all strategies.
							These must be fractions or decimal numbers with no greater than four digits following the decimal.
						</div>
					</aside>
					<div id="exprMatrix"></div>
					<form method="post" action="@@cgibin@@/doplay.json" id="playGame" onsubmit="return(playGame(this));">
						<div id="playGameErrorState" class="noshow">
							<div class="warning">
								<div>
									<i class="fa fa-exclamation-circle"></i>
									<span>
										You've already played this game.  (Did you play twice?) 
										<a href="#" onclick="window.location.reload(true);">Reload</a> to refresh the game view.
									</span>
								</div>
							</div>
						</div>
						<div id="playGameErrorForm" class="noshow">
							<div class="warning">
								<div>
									<i class="fa fa-exclamation-circle"></i>
									<span>Form not correctly filled out.</span>
								</div>
							</div>
						</div>
						<div id="playGameErrorJson" class="noshow">
							<div class="warning">
								<div>
									<i class="fa fa-warning"></i>
									<span>A system error occured.</span>
								</div>
							</div>
						</div>
						<input type="hidden" id="exprPlayGid" name="gid" />
						<input type="hidden" id="exprPlayRound" name="round" />
						<fieldset id="exprPlayList"></fieldset>
					</form>
				</section>
			</div>
		</article>
		<article id="defaultTab" class="tab">
			<h2>Instructions</h2>
			<div id="instructionsLoading"><i class="fa fa-spinner fa-spin"></i></div>
			<div id="instructionsLoaded"></div>
			<form id="instructionsPrompt" action="@@cgibin@@/doinstr.json" method="post" onsubmit="return(updateInstr(this));">
				<input type="checkbox" name="instr" id="instructionsPromptYes" value="1" />
				<label for="instructionsPromptYes">Show me these instructions when I log in.</label>
				<input type="submit" value="Update" />
			</form>
		</article>
		<footer>
			&copy; 2014, 
			<a href="http://www.kcons.eu"><i>k</i>-Consulting</a>
			<a href="@@cgibin@@/privacy.html">Privacy</a>
		</footer>
	</body>
</html>
